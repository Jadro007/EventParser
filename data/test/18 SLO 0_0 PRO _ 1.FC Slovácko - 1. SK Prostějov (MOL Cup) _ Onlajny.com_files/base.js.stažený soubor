if (typeof String.prototype.trim !== 'function') {
    String.prototype.trim = function () {
        return this.replace(/^\s+|\s+$/g, '');
    }
}

$(function () {
    initStickyBanner();
});

function closeFancyBox() {
    $.fancybox.close();
}
//window.addEventListener("message", closeFancyBox, false);

$(document).ready(function () {
    $(".tip-fancybox").fancybox({
        type: "iframe",
        autoSize: false,
        width: 600,
        height: 500,
        autoCenter: true,
        keys: {
            close: [27] // escape key
        }
    });

    $(".maximizeMinimize").click(function () {
        var $this = $(this);
        $this.closest(".header").next(".maxMinHolder").toggle();
        $this.toggleClass('maximized').toggleClass('minimized');
    });
});

function kalendarikClick(url) {
    if ($('#kalendarHolder').hasClass('hidden')) {
        ajaxChangeCalendar(url);
        $('#kalendarHolder').removeClass('hidden');
        $('#kalendarHolder').addClass('visible-block');
    } else {
        $('#kalendarHolder').removeClass('visible-block');
        $('#kalendarHolder').addClass('hidden');
    }
}

function ajaxChangeCalendar(url) {
    $.get(url, function (data) {
        $("#kalendarHolder").html(data);
    });
}

function ajaxChangeComments(type) {

    hideComments(type);
    $.get($('#match-submenu').data("url").replace(/XXX/, type), function (data) {

        var comments = $("#comments");
        comments.before($("#fb-root")).html(data);

        var $gfyitems = document.getElementsByClassName("gfyitem");
        var $gfycount = $gfyitems.length;
        if ($gfycount > 0) {
            for (i = 0; i < $gfycount; i++) {
                var gfyObj = new gfyObject($gfyitems[0]);
                gfyObj.init();
            }
        }

        if (typeof FB != "undefined" && data.indexOf("fb-post") >= 0) {
            FB.XFBML.parse(comments[0]);
        }

        if (typeof instgrm != "undefined" && data.indexOf("instagram-media") >= 0) {
            instgrm.Embeds.process();
        }

        $("img.embed-photo:not(.nofancybox)", comments).each(function () {
            $(this).fancybox({
                href: $(this).attr('src').replace(/([_-])w390/, '$1w1000')
            });
        });

        $("div.js-comment-analysis, div.js-comment-bets", comments).each(function () {
            initTipsort($(this).closest("tr")[0]);
        });

        if (typeof ga !== "undefined") {
            ga('localTracker.send', 'event', 'Filtr komentářů', type, matchJson.sport);
        } else if (typeof _gaq !== "undefined") {
            _gaq.push(['_trackEvent', 'Filtr komentářů', type, matchJson.sport]);
        }
    });
}

function hideComments(elmId) {
    $('.navigace .tabSelected').removeClass('tabSelected');
    $("#" + elmId + "Tab").addClass('tabSelected');
}

function hideCompetitions(elmId) {
    $('#detailZapasLigyBox table').each(function (i, e) {
        if (!$("#" + e.id).hasClass('hidden')) {
            $("#" + e.id).addClass('hidden');
        }
    });
    $("#zapasLigyBox" + elmId).removeClass('hidden');


    $('#detailZapasLigyNavigace div').each(function (i, e) {
        if (e.id && $("#" + e.id).hasClass('tabSelected')) {
            $("#" + e.id).removeClass('tabSelected');
        }
    });

    $("#zapasLigyNavigace" + elmId).addClass('tabSelected');
}


function initRotateBanner(times, pos) {
    var first = Math.floor(Math.random() * times.length);
    banners[pos] = first;
    $(".banner-" + pos + "-" + first).show();
    if (times[first] > 0 && times.length > 1) {
        setTimeout(function () {
            rotateBanner(times, pos);
        }, times[first] * 1000);
    }

}

function rotateBanner(times, pos) {
    nr = banners[pos];
    if (!times[nr]) {
        return;
    }
    for (i = 0; i < times.length; i++) {
        $(".banner-" + pos + "-" + i).hide();
    }
    $(".banner-" + pos + "-" + nr).show();
    if (nr < times.length - 1) {
        nxt = nr + 1;
    } else {
        nxt = 0;
    }
    banners[pos] = nxt;
    setTimeout(function () {
        rotateBanner(times, pos);
    }, times[nr] * 1000);
}

function urldecode(str) {
    return decodeURIComponent(str.replace(/\+/g, '%20'));
}

function betBoxOver(id) {
    var posOdd = $("#bet_odd_" + id).offset();
    $("#bet_box_" + id).css({
        "left": (posOdd.left - 87) + "px",
        "top": (posOdd.top - 90) + "px"
    });
    $("#bet_box_" + id).show(0);
}

function betBoxOut(id) {
    $("#bet_box_" + id).hide(0);
}

function tvBoxOver(id) {
    var pos = $("#tv_box_" + id).offset();
    //alert(pos.left + ',' + pos.top);
    $("#tv_box_" + id + ' .tv_box').css({
        "left": (pos.left - 93) + "px",
        "top": (pos.top - 45) + "px"
    });
    $("#tv_box_" + id + ' .tv_box').show(0);
}

function tvBoxOut(id) {
    $("#tv_box_" + id + ' .tv_box').hide(0);
}

function betLiveOver(id) {
    if ($("#sazky_item_" + id + " .hasBefore").length) {
        $("#sazky_live_item_" + id).addClass("tmpHidden");
        $("#sazky_item_" + id).addClass("tmpHidden");
        $("#sazky_before_item_" + id).show(0);
    }
}

function betBeforeOut(id) {
    var sazkyBefore = $("#sazky_before_item_" + id);
    if (!sazkyBefore.hasClass("fixed")) {
        sazkyBefore.hide(0);
        $("#sazky_live_item_" + id).removeClass("tmpHidden");
        $("#sazky_item_" + id).removeClass("tmpHidden");
    }
}

function matchesStatusTypeChange(type, date) {
    matchesStatusTypeSet(type)
    initMatchesByStatusType(type, date);
}

function matchesStatusTypeSet(type) {
    setCookie('matchesStatusType', type, null);
    return true;
}


function initMatchesByStatusType(type, date) {
    var defaultMask = '.zapasyPolozka';
    var mask = '';
    var onClass = type;
    if (type == 'live') {
        mask = '.zapasyPolozka[class*="match-status-1"], .zapasyPolozka[class*="match-status-2"], .zapasyPolozka[class*="match-status-3"], .zapasyPolozka[class*="match-status-4"], .zapasyPolozka[class*="match-status-5"], .zapasyPolozka[class*="match-status-6"], .zapasyPolozka[class*="match-status-7"], .zapasyPolozka[class*="match-status-8"], .zapasyPolozka.match-status-n, .zapasyPolozka.match-status-zs';
    } else if (type == 'before') {
        mask = '.zapasyPolozka.match-status-0';
    } else if (type == 'finished') {
        mask = '.zapasyPolozka[class*="match-status-k"], .zapasyPolozka[class*="match-status-x"]';
    } else if (type == 'own') {
        onClass = 'own';
    } else {
        mask = defaultMask;
        onClass = 'all';
    }

    if (type == 'own') {
        initMatchesOwn(date);
        $('.zapasyDetail').show();
    } else {
        $('.soutezHolder').show();
        $('.zapasyHolder').show();
        if (mask != defaultMask) {
            $('.zapasyPolozka').hide();
        }
        $(mask).show();
        $('.zapasyDetail').hide();
        initCompetitionsSportsHolder();
    }

    initButtons(onClass);

    if ($('.zapasyPolozka:visible').length > 0) {
        $('.no-match-filter').hide();
    } else {
        $('.no-match-filter').show();
    }
    
   
    $('.stats-menu, .zapasyDetail ').toggle(type == 'live' || type == 'own');
    if(type == 'live' || type == 'own') {
         $('.stats-menu').show();
         $('.zapasyDetail').each(function () {
            $(this).toggle($('.statistics-some:visible', this).length > 0);         
        }); 
        initMatchesGridObject(schemaStats);
    }
    else {
        $('.stats-menu, .zapasyDetail ').hide();
        initMatchesGridObject(schema);
    }
    //$('.match-own').hide();
}

function initCompetitionsSportsHolder() {
    $('.soutezHolder:not(:has(.zapasyPolozka:visible))').hide();
    $('.soutezHolder:has(.zapasyPolozka:visible)').show();

    $('.zapasyHolder:not(:has(.zapasyPolozka:visible))').hide();
    $('.zapasyHolder:has(.zapasyPolozka:visible)').show();

    $.each($(".soutezHolder"), function () {
        if ($("input:checkbox[name='matchOwn[]']:visible:not(:checked)", this).length > 0) {
            $("input:checkbox[name='competitionOwn[]']", this).attr('checked', false);
        } else {
            $("input:checkbox[name='competitionOwn[]']", this).attr('checked', true);
        }
    });

    $.each($(".zapasyHolder"), function () {
        if ($("input:checkbox[name='matchOwn[]']:visible:not(:checked)", this).length > 0) {
            $("input:checkbox[name='sportOwn[]']", this).attr('checked', false);
        } else {
            $("input:checkbox[name='sportOwn[]']", this).attr('checked', true);
        }
    });
}

function setCookie(c_name, value, exdays) {
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString());
    document.cookie = c_name + "=" + c_value + '; path=/';
}

function getCookie(c_name) {
    var i, x, y, ARRcookies = document.cookie.split(";");
    for (i = 0; i < ARRcookies.length; i++) {
        x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
        y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
        x = x.replace(/^\s+|\s+$/g, "");
        if (x == c_name) {
            return unescape(y);
        }
    }
}

function matchesOwnChange() {
    $('.zapasyPolozka').show();
    $('.soutezHolder').show();
    $('.zapasyHolder').show();
}

function matchesOwnFromService(date) {
    var ownCookie = getCookie('matchesOwn' + date);
    if (ownCookie) {
        matchesStatusTypeSet('own');
        return true;
    } else {
        matchesStatusTypeSet('');
        location.href = '/';
        return false;
    }
}


function matchesOwnSave(elm, date) {
    var values = new Array();
    var valuesOld;
    var valuesStr = getCookie('matchesOwn' + date);
    if (valuesStr) {
        valuesOld = valuesStr.split(',');
    } else {
        valuesOld = new Array();
    }

    $.each($("input:checkbox:checked[name='matchOwn[]']"), function () {
        if ($.inArray($(this).val(), values) < 0) {
            values.push($(this).val());
        }
    });

    for (var i = 0; i < valuesOld.length; i++) {
        if ($.inArray(valuesOld[i], values) < 0 && $("input:checkbox[name='matchOwn[]'][value='" + valuesOld[i] + "']").length == 0) {
            values.push(valuesOld[i]);
        }
    }


    setCookie('matchesOwn' + date, values.join(','), null);

    if ($('.button.own').hasClass('on')) {
        initMatchesOwn(date);
    }
}

function initButtons(onClass) {
    $('#subnavigace a.button').removeClass('on');
    $('#subnavigace a.button').addClass('off');
    $('#subnavigace a.' + onClass).removeClass('off');
    $('#subnavigace a.' + onClass).addClass('on');
}

function initMatchesOwn(date) {
    var ownCookie = getCookie('matchesOwn' + date);
    if (!ownCookie) {
        ownCookie = new Array();
    }

    $('.zapasyPolozka').show();
    $('.soutezHolder').show();
    $('.zapasyHolder').show();
    //if(ownCookie) {     
    initMatchesOwnChck(date);
    //$("input:checkbox[name='matchOwn[]']").closest('.zapasyPolozka').show();         
    var allUnchecked = $("input:checkbox[name='matchOwn[]']:not(:checked)");
    $(allUnchecked).closest('.zapasyPolozka').hide();
    initCompetitionsSportsHolder();
    //}          
}

function initMatchesOwnChck(date) {
    var ownCookie = getCookie('matchesOwn' + date);
    if (ownCookie) {
        var ownArr = ownCookie.split(",");
        for (var key in ownArr) {
            var chck = $("input:checkbox[name='matchOwn[]'][value='" + ownArr[key] + "']");
            //$(chck).fancyopts('check', true);
            $(chck).attr('checked', true);
        }
    }
}



function sportOwnClick(elm, isHp, date) {
    var holder = $(elm).closest('.zapasyHolder');
    $("input:checkbox[name='matchOwn[]'], input:checkbox[name='competitionOwn[]']", holder).fancyopts('check', $(elm).attr('checked'));
    //$("input:checkbox[name='matchOwn[]'], input:checkbox[name='competitionOwn[]']", holder).attr('checked', $(elm).attr('checked'));     
    //if (! isHp && $('.button.own').hasClass('on')) {         
    //    matchesOwnSave(date, isHp);
    //}
    matchesOwnSave(null, date);
}

function competitionOwnClick(elm, isHp, date) {
    var holder = $(elm).closest('.soutezHolder');
    $("input:checkbox[name='matchOwn[]']", holder).fancyopts('check', $(elm).attr('checked'));
    //$("input:checkbox[name='matchOwn[]']", holder).attr('checked', $(elm).attr('checked'));
    //if (! isHp && $('.button.own').hasClass('on')) {         
    //    matchesOwnSave(date, isHp);
    //}
    matchesOwnSave(null, date);
}

function matchOwnClick(elm, date) {
    //if (! isHp && $('.button.own').hasClass('on')) {         
    //    matchesOwnSave(elm, date);
    //}
}

function matchesOwnCheck(date) {
    matchesStatusTypeSet('own');
    var values = getCookie('matchesOwn' + date);

    if (!values || !values.length) {
        alert($('#set-own-help').html());
        return false;
    }
    return true;
}

function initHpTime(datestr) {
    var date = new Date(datestr);
    setTimeout(function () {
        changeHpTime(date);
    }, 30000);
}

function changeHpTime(date) {
    date.setSeconds(date.getSeconds() + 60);
    var h = date.getUTCHours();
    if (h < 10) {
        h = "0" + h;
    }
    var m = date.getUTCMinutes();
    if (m < 10) {
        m = "0" + m;
    }
    $('.datumCas').html(h + ':' + m);
    setTimeout(function () {
        changeHpTime(date);
    }, 60000);
}

function initFancyOpts() {
    $("input.muj_vyber[type='checkbox']").show();
    $("input.muj_vyber[type='checkbox']").fancyopts({
        activeHover: true,
        width: 20,
        height: 20,
        image: imgBase + 'checkbox.png',
    });
}



function initMulti(date) {
    initMultiMatches(date);
}

function initMultiMatches(date) {
    $('#multiPrehled .match').hide();
    var values = getOwnMatchesDate(date);
    /* for (var key in values) {
         $('#multiPrehled .match-' + values[key]).show();
     }*/
    var index;
    for (index = 0; index < values.length; ++index) {
        $('#multiPrehled .match-' + values[index]).show();
    }

    var firstIdMatch = $('#multiPrehled .match:visible:first input[name="idMatch[]"]').val();
    switchMultiReport(firstIdMatch);

    initMultiEmpty();
}

function switchMultiReport(idMatch) {
    $('.tabBox1').hide();
    $('#multiPrehled .matchInfo').attr('checked', false);

    if (idMatch) {
        var tabBox = $('#tabBox-' + idMatch);
        tabBox.show();
        var matchElm = $('#multiPrehled .match-' + idMatch);
        $('.matchInfo', matchElm).attr('checked', true);
        var tr = $('.match-log tr[id^="log-"]', tabBox);
        var streamItem = tr.data("streamitem");
        if (streamItem) {
            new logGridObject(tr.attr("id"), streamItem, true);
        }
    }
}

function initMultiEmpty() {
    if ($('#multiPrehled .match:visible').length) {
        $('#multiEmpty').hide();
    } else {
        $('#multiEmpty').show();
    }
}

function getOwnMatchesDate(date) {
    var values;
    var valuesStr = getCookie('matchesOwn' + date);
    if (valuesStr) {
        values = valuesStr.split(',');
    }
    if (!values) {
        values = new Array();
    }

    return values;
}

function hideMultiMatch(elm, date) {
    $(elm).closest('.match').hide();
    saveMultiMatches(date);
    type = getMultiCommnentsType();
    initLsMultiCommentsType(type);
    initMultiEmpty();

    if (('.matchInfo:checked:visible').length) {
        var firstIdMatch = $('#multiPrehled .match:visible:first input[name="idMatch[]"]').val();
        switchMultiReport(firstIdMatch);
    }

    return false;
}

function showMultiMatch(matchId) {
    if (matchId) {
        var matchElm = $('#multiPrehled .match-' + matchId);
    }
    $('#multiPrehled .noFilter').hide();
    $('#multiPrehled .matchFilter').removeClass('bold');
    if (matchId) {
        $('.noFilter', matchElm).show();
        $('.matchFilter', matchElm).addClass('bold');
        switchMultiReport($('input[name="idMatch[]"]', matchElm).val());
    }
    type = getMultiCommnentsType();
    initLsMultiCommentsType(type);

    return false;
}

function saveMultiMatches(date) {
    var values = [];
    $('#multiPrehled .match:visible').each(function (i, e) {
        values[i] = $('input[name="idMatch[]"]', this).val();
    });
    setCookie('matchesOwn' + date, values.join(','), null);
}

function changeMultiType(type) {
    $('.navigace .tabSelected').removeClass('tabSelected');
    $('#' + type + 'Tab').attr('class', 'tabSelected');
    initLsMultiCommentsType(type);

    return false;
}

function changeMultiCompetition(id, date) {
    $('#multiPrehled .match:visible').hide();
    $('#multiPrehled .competition-' + id).show();
    saveMultiMatches(date);
    initMultiEmpty();

    var firstIdMatch = $('#multiPrehled .competition-' + id + ':first input[name="idMatch[]"]').val();
    switchMultiReport(firstIdMatch);

    type = getMultiCommnentsType();
    initLsMultiCommentsType(type);


    return false;
}

function changeHpMultiCompetition(elm, date) {
    var holder = $(elm).closest('.soutezHolder');
    var values = [];
    $('input[name="matchOwn[]"]:visible', holder).each(function (i, e) {
        values[i] = $(this).val();
    });
    setCookie('matchesOwn' + date, values.join(','), null);

    return true;
}

function getMultiCommnentsType() {
    return $('.navigace .tabSelected').attr('id').replace('Tab', '');
}

function hideStatistics(type, hide) {       
    setCookie('hideStatistics' + type, hide, null);
    statistic(type);
    return false;
}

function statistics(sportId) {      
    statistic('stats-' + sportId);
    statistic('comments-' + sportId);
    statistic('details-' + sportId);
    
    if(! $('.stats-menu:visible').length) {
        $('.zapasyDetail').hide();
    }
}

function statistic(type) {    
    var hide = getCookie('hideStatistics' + type); 
    if (hide == undefined) {                
        return;
    }
    
    $('#hide-statistics-' + type + ',.statistics-' + type).toggle(hide != 1);
    $('#show-statistics-' + type).toggle(hide == 1);  
    if(hide != 1) {        
         $('.zapasyDetail').show();
    }       
    $('.zapasyDetail').each(function () {
        $(this).toggle($('.statistics-some:visible', this).length > 0);         
    });     
}

function toggleMultimediaVisibility(hide) {
    setCookie('hideMultimedia', hide, null);
    initMultimediaVisibility();
    return false;
}

function initMultimediaVisibility() {
    var hideMultimedia = getCookie('hideMultimedia');
    if (hideMultimedia == 1) {
        $('#detailZapasLeftPane').addClass('multimedia-hide');
        $('#hideMultimedia').hide();
        $('#showMultimedia').show();
    } else {
        $('#detailZapasLeftPane').removeClass('multimedia-hide');
        $('#showMultimedia').hide();
        $('#hideMultimedia').show();
    }
}

var arrowDims = {
    cs: 90,
    sk: 90,
    pl: 100,
    hu: 110,
    ru: 135,
    en: 115
};

var arrowWidth = arrowDims[lang];

function initNextLeagues() {
    var leagues = $("#detailZapasLigyNavigace");
    if (leagues.length) {

        // Width of holder
        var arrowSpace = arrowWidth;
        var holderWithoutArrow = leagues.width();
        var holder = leagues.width() - arrowSpace;
        var leagueTabs = $(".tab", leagues);

        var leaguesWidth = 0;
        var needsArrow = false;

        leagueTabs.each(function (index) {
            var tabWidth = $(this).outerWidth() + parseInt($(this).css("margin-right"));
            leaguesWidth += tabWidth;

            if (leaguesWidth >= holderWithoutArrow) {
                needsArrow = true;
            }
        });

        var firstHidden;
        var leaguesWidth = 0;

        if (needsArrow) {
            leagueTabs.each(function (index) {
                var tabWidth = $(this).outerWidth() + parseInt($(this).css("margin-right"));
                leaguesWidth += tabWidth;

                if (leaguesWidth >= holder) {
                    firstHidden = index;
                    return false;
                }
            });

            if (firstHidden > 0 && firstHidden <= leagueTabs.length) {
                leagues.addClass("with-hidden-leagues");
                var hiddenLeagues = leagueTabs.slice(firstHidden, leagueTabs.length);
                hiddenLeagues.wrapAll("<div id='hidden-leagues-wrapper' style='width:" + arrowWidth + "px;'></div>").wrapAll("<div id='hidden-leagues'></div>");
                $("#hidden-leagues-wrapper").prepend("<span id='other-leagues' style='width:" + arrowWidth + "px;'>" + translate("otherLeagues") + "</span>")
            }
        }

    }
}

function initStickyBanner() {

    var $sticky = $("#banner-left-pane .sticky-banner");

    if ($("#content").height() < 960) {
        return false;
    }

    if (!!$sticky.offset()) {

        var stickyTop = $sticky.offset().top;

        $(window).scroll(function () {

            if ($("#content").height() < 960) {
                return false;
            }

            var footerTop = $("#spodniMenu").offset().top;
            var windowTop = $(window).scrollTop();
            var leftPaneTop = $("#leftPane").offset().top;
            if (stickyTop < windowTop) {

                $sticky.css({
                    position: 'absolute',
                    top: windowTop - leftPaneTop + "px",
                });

                var newSticky = $sticky.offset().top + $sticky.height();
                if (newSticky > footerTop) {

                    $sticky.css({
                        position: 'absolute',
                        top: windowTop - leftPaneTop - (newSticky - footerTop + 20)
                    });
                }
            } else {
                $sticky.css({
                    position: 'static',
                    top: 'auto'
                });
            }
        });
    }
}

$(function () {
    $(".rollout-banner .button").click(function () {
        var $banner = $(this).parent();
        $banner.toggleClass("opened");
        $(".rollout-banner-closed, .rollout-banner-opened", $banner).slideToggle();
    });
});

function resetStickyBannerPosition() {
    if ($("#content").height() < 960) {
        $("#banner-left-pane .sticky-banner").css({
            position: 'static',
            top: 'auto'
        });
    }
}

$(function () {
    $(document).tooltip({
        items: ".mytooltip",
        content: function () {
            return $(this).attr('title');
        },
        position: {
            my: "center top+10",
            at: "center bottom",
            using: function (position, feedback) {
                $(this).css(position);
                $("<div>")
                    .addClass("arrow")
                    .addClass("v-" + feedback.vertical)
                    .addClass("h-" + feedback.horizontal)
                    .appendTo(this);
            }
        }
    });
});

// GFYCAT
var gfyCollection = function () {
    var collection = [];

    function byClass(className, obj) {
        if (obj.getElementsByClassName) {
            return obj.getElementsByClassName(className)
        } else {
            var retnode = [];
            var elem = obj.getElementsByTagName("*");
            for (var i = 0; i < elem.length; i++) {
                if ((" " + elem[i].className + " ").indexOf(" " + className + " ") > -1) {
                    retnode.push(elem[i])
                }
            }
            return retnode
        }
    }

    function init() {
        elem_coll = byClass("gfyitem", document);
        for (var i = 0; i < elem_coll.length; i++) {
            var gfyObj = new gfyObject(elem_coll[i]);
            console.log(i);
            collection.push(gfyObj)
        }
        for (var i = 0; i < collection.length; i++) {
            collection[i].init()
        }
    }

    function get() {
        return collection
    }
    return {
        init: init,
        get: get
    }
}();
var gfyObject = function (gfyElem) {
    var gfyRootElem = gfyElem;
    var gfyId;
    var optExpand;
    var optTitle;
    var optCtrls;
    var optAutoplay = true;
    var ctrlBox;
    var ctrlPausePlay;
    var ctrlSlower;
    var ctrlFaster;
    var vid;
    var gif;
    var overlayCanvas;
    var titleDiv;
    var isMobile;
    var isReverse = false;
    var isGifOnly = false;
    var self = this;
    var gfyItem;
    var gfyWidth;
    var gfyHeight;

    function byClass(className, obj) {
        if (obj.getElementsByClassName) {
            return obj.getElementsByClassName(className)
        } else {
            var retnode = [];
            var elem = obj.getElementsByTagName("*");
            for (var i = 0; i < elem.length; i++) {
                if ((" " + elem[i].className + " ").indexOf(" " + className + " ") > -1) {
                    retnode.push(elem[i])
                }
            }
            return retnode
        }
    }

    function createTitle() {
        titleDiv = document.createElement("div");
        titleDiv.style.position = "absolute";
        try {
            titleDiv.style.backgroundColor = "rgba(0,0,0,0.4)"
        } catch (e) {
            titleDiv.style.backgroundColor = "#000";
            try {
                titleDiv.style.filter = "alpha(opacity=60)"
            } catch (e) {}
        }
        titleDiv.style.color = "#fff";
        titleDiv.style.fontFamily = "Arial,sans-serif";
        titleDiv.style.fontSize = "20px";
        titleDiv.style.padding = "10px";
        titleDiv.innerHTML = gfyItem.title;
        titleDiv.style.left = "0";
        titleDiv.style.top = "0";
        titleDiv.style.display = "none";
        gfyRootElem.appendChild(titleDiv)
    }

    function createOverlayCanvas() {
        overlayCanvas = document.createElement("canvas");
        overlayCanvas.style.position = "absolute";
        overlayCanvas.style.left = "0";
        overlayCanvas.style.top = "0";
        overlayCanvas.onclick = pauseClick;
        overlayCanvas.onmouseout = gfyMouseOut;
        overlayCanvas.onmouseover = gfyMouseOver;
        gfyRootElem.appendChild(overlayCanvas)
    }

    function createVidTag() {
        vid = document.createElement("video");
        vid.muted = true;
        vid.className = "gfyVid";
        if (optAutoplay) {
            vid.autoplay = true
        }
        vid.loop = true;
        if (isMobile) {
            vid.controls = true
        } else {
            vid.controls = false
        }
        vid.style.width = "100%";
        vid.style.height = "auto";
        vid.setAttribute("poster", "https://thumbs.gfycat.com/" + gfyItem.gfyName + "-poster.jpg");
        source2 = document.createElement("source");
        source2.src = gfyWebmUrl;
        source2.type = "video/webm";
        source2.className = "webmsource";
        vid.appendChild(source2);
        source = document.createElement("source");
        source.src = gfyMp4Url;
        source.type = "video/mp4";
        source.className = "mp4source";
        vid.appendChild(source);
        gfyRootElem.appendChild(vid)
    }

    function mobilecheck() {
        var check = false;
        (function (a) {
            if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|android|ipad|playbook|silk|blackberry|htc|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) {
                check = true
            }
        })(navigator.userAgent || navigator.vendor || window.opera);
        return check
    }

    function createGifTag() {
        gif = document.createElement("img");
        gif.src = gfyItem.gifUrl;
        if (optExpand) {
            gif.style.width = "100%"
        } else {
            gif.style.maxWidth = gfyItem.width + "px"
        }
        gif.style.height = "auto";
        gif.onmouseout = gfyMouseOut;
        gif.onmouseover = gfyMouseOver;
        gfyRootElem.appendChild(gif);
        gfyRootElem.style.position = "relative";
        gfyRootElem.style.padding = 0
    }

    function setWrapper() {
        gfyRootElem.style.position = "relative";
        gfyRootElem.style.padding = 0;
        if (!optExpand) {
            gfyRootElem.style.display = "inline-block";
            gfyRootElem.style.overflow = "hidden";
            gfyRootElem.style.boxSizing = "border-box";
            gfyRootElem.style.MozBoxSizing = "border-box";
            gfyRootElem.style.webkitBoxSizing = "border-box"
        }
    }

    function createCtrlBox() {
        if (!optCtrls) {
            return
        }
        ctrlRow = document.createElement("div");
        ctrlRow.style.position = "relative";
        ctrlBox = document.createElement("div");
        ctrlBox.className = "CtrlBox";
        ctrlPausePlay = document.createElement("img");
        ctrlPausePlay.className = "gfyCtrlPause";
        ctrlPausePlay.src = "https://assets.gfycat.com/img/placeholder.png";
        ctrlPausePlay.style.backgroundImage = "url('https://assets.gfycat.com/img/gfycontrols.png')";
        ctrlPausePlay.style.cssFloat = "right";
        ctrlPausePlay.style.marginRight = "5px";
        ctrlPausePlay.style.width = "12px";
        ctrlPausePlay.style.height = "12px";
        ctrlPausePlay.style.borderStyle = "none";
        ctrlBox.appendChild(ctrlPausePlay);
        ctrlReverse = document.createElement("img");
        ctrlReverse.className = "gfyCtrlReverse";
        ctrlReverse.src = "https://assets.gfycat.com/img/placeholder.png";
        ctrlReverse.style.backgroundImage = "url('https://assets.gfycat.com/img/gfycontrols.png')";
        ctrlReverse.style.cssFloat = "right";
        ctrlReverse.style.marginRight = "5px";
        ctrlReverse.style.width = "14px";
        ctrlReverse.style.height = "12px";
        ctrlReverse.style.backgroundPosition = "-46px 0";
        ctrlReverse.style.borderStyle = "none";
        ctrlSlower = document.createElement("img");
        ctrlSlower.className = "gfyCtrlSlower";
        ctrlSlower.src = "https://assets.gfycat.com/img/placeholder.png";
        ctrlSlower.style.backgroundImage = "url('https://assets.gfycat.com/img/gfycontrols.png')";
        ctrlSlower.style.marginRight = "5px";
        ctrlSlower.style.width = "14px";
        ctrlSlower.style.height = "12px";
        ctrlSlower.style.cssFloat = "right";
        ctrlSlower.style.borderStyle = "none";
        ctrlFaster = document.createElement("img");
        ctrlFaster.className = "gfyCtrlFaster";
        ctrlFaster.src = "https://assets.gfycat.com/img/placeholder.png";
        ctrlFaster.style.backgroundImage = "url('https://assets.gfycat.com/img/gfycontrols.png')";
        ctrlFaster.style.width = "14px";
        ctrlFaster.style.height = "12px";
        ctrlFaster.style.cssFloat = "right";
        ctrlFaster.style.marginRight = "5px";
        ctrlFaster.style.borderStyle = "none";
        if (vid.paused) {
            setCtrlsPaused()
        } else {
            setCtrlsPlaying()
        }
        ctrlBox.style.position = "relative";
        ctrlBox.style.cssFloat = "right";
        ctrlBox.style.width = "100px";
        ctrlBox.style.padding = "5px";
        ctrlBox.style.margin = "0";
        ctrlBox.setAttribute("id", "ctr" + gfyId);
        ctrlPausePlay.onclick = pauseClick;
        ctrlReverse.onclick = reverse;
        ctrlBox.appendChild(ctrlFaster);
        ctrlBox.appendChild(ctrlSlower);
        ctrlBox.appendChild(ctrlReverse);
        ctrlBox.appendChild(ctrlPausePlay);
        ctrlRow.appendChild(ctrlBox);
        gfyRootElem.appendChild(ctrlRow)
    }

    function deleteVidTag() {
        gfyRootElem.removeChild(vid)
    }

    function init() {
        isMobile = mobilecheck();
        gfyId = gfyRootElem.getAttribute("data-id");
        console.log(gfyId);
        if (gfyRootElem.getAttribute("data-title") == "true") {
            optTitle = true
        }
        if (gfyRootElem.getAttribute("data-expand") == "true") {
            optExpand = true
        }
        if (gfyRootElem.getAttribute("data-controls") == "true") {
            optCtrls = true
        }
        if (gfyRootElem.getAttribute("data-autoplay") == "false") {
            optAutoplay = false
        }
        var newElem = document.createElement("div");
        attrib_src = gfyRootElem.attributes;
        attrib_dest = newElem.attributes;
        for (var i = 0; i < attrib_src.length; i++) {
            var tst = attrib_src.item(i);
            var tst2 = tst.cloneNode();
            if (tst2.name == "style" && tst.value != "null") {
                attrib_dest.setNamedItem(tst2)
            } else {}
        }
        gfyRootElem.parentNode.replaceChild(newElem, gfyRootElem);
        gfyRootElem = newElem;
        loadJSONP("https://gfycat1.datasport.cz/index.php?id=" + gfyId, function (data) {
            if (data) {
                gfyItem = data.gfyItem;
                gfyMp4Url = gfyItem.mp4Url;
                gfyWebmUrl = gfyItem.webmUrl;
                gfyFrameRate = gfyItem.frameRate;
                if (document.createElement("video").canPlayType) {
                    createVidTag();
                    setWrapper();
                    createTitle();
                    createOverlayCanvas();
                    if (vid.addEventListener) {
                        vid.addEventListener("loadedmetadata", vidLoaded, false)
                    } else {
                        vid.attachEvent("onloadedmetadata", vidLoaded)
                    }
                    if (optAutoplay) {
                        vid.play()
                    }
                } else {
                    isGifOnly = true;
                    createGifTag();
                    createTitle();
                    gif.onload = function () {
                        var ua = navigator.userAgent.toLowerCase();
                        if (ua.indexOf("msie") > -1) {
                            titleDiv.style.width = gif.clientWidth + "px"
                        } else {
                            titleDiv.style.width = gif.clientWidth - 20 + "px"
                        }
                    }
                }
            } else {}
        })
    }

    function loadJSONP(url, callback, context) {
        var unique = Math.floor((Math.random() * 10000000) + 1);
        var name = "_" + gfyId + "_" + unique++;
        if (url.match(/\?/)) {
            url += "&callback=" + name
        } else {
            url += "?callback=" + name
        }
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = url;
        window[name] = function (data) {
            callback.call((context || window), data);
            document.getElementsByTagName("head")[0].removeChild(script);
            script = null;
            try {
                delete window[name]
            } catch (e) {}
        };
        document.getElementsByTagName("head")[0].appendChild(script)
    }

    function setSize() {
        gfyWidth = vid.offsetWidth;
        gfyHeight = vid.offsetHeight;
        if (!optExpand && gfyWidth > vid.videoWidth) {
            gfyWidth = vid.videoWidth;
            gfyHeight = vid.videoHeight
        }
        overlayCanvas.width = gfyWidth;
        overlayCanvas.height = gfyHeight;
        titleDiv.style.width = gfyWidth - 20 + "px"
    }

    function vidLoaded() {
        setSize();
        if (!ctrlBox) {
            createCtrlBox()
        }
        if (!optAutoplay && !isMobile) {
            drawPlayOverlay()
        }
    }

    function clearPlayOverlay() {
        var ctx = overlayCanvas.getContext("2d");
        if (gfyWidth) {
            ctx.clearRect(0, 0, gfyWidth, gfyHeight)
        }
    }

    function drawPlayOverlay() {
        var ctx = overlayCanvas.getContext("2d");
        ctx.clearRect(0, 0, gfyWidth, gfyHeight);
        ctx.strokeStyle = "#ffffff";
        ctx.fillStyle = "#ffffff";
        ctx.lineWidth = 5;
        var pWidth = 70;
        var pHeight = 80;
        var pRad = 5;
        if (gfyHeight < 160 || gfyWidth < 200) {
            pHeight = pHeight * gfyHeight / 240;
            pWidth = pWidth * gfyHeight / 240;
            pRad = 3
        }
        drawPolygon(ctx, [
            [gfyWidth / 2 - pWidth / 2, gfyHeight / 2 - pHeight / 2],
            [gfyWidth / 2 + pWidth / 2, gfyHeight / 2],
            [gfyWidth / 2 - pWidth / 2, gfyHeight / 2 + pHeight / 2]
        ], pRad);
        ctx.stroke();
        ctx.fill()
    }

    function drawPolygon(ctx, pts, radius) {
        if (radius > 0) {
            pts = getRoundedPoints(pts, radius)
        }
        var i, pt, len = pts.length;
        ctx.beginPath();
        for (i = 0; i < len; i++) {
            pt = pts[i];
            if (i == 0) {
                ctx.moveTo(pt[0], pt[1])
            } else {
                ctx.lineTo(pt[0], pt[1])
            }
            if (radius > 0) {
                ctx.quadraticCurveTo(pt[2], pt[3], pt[4], pt[5])
            }
        }
        ctx.closePath()
    }

    function getRoundedPoints(pts, radius) {
        var i1, i2, i3, p1, p2, p3, prevPt, nextPt, len = pts.length,
            res = new Array(len);
        for (i2 = 0; i2 < len; i2++) {
            i1 = i2 - 1;
            i3 = i2 + 1;
            if (i1 < 0) {
                i1 = len - 1
            }
            if (i3 == len) {
                i3 = 0
            }
            p1 = pts[i1];
            p2 = pts[i2];
            p3 = pts[i3];
            prevPt = getRoundedPoint(p1[0], p1[1], p2[0], p2[1], radius, false);
            nextPt = getRoundedPoint(p2[0], p2[1], p3[0], p3[1], radius, true);
            res[i2] = [prevPt[0], prevPt[1], p2[0], p2[1], nextPt[0], nextPt[1]]
        }
        return res
    }

    function getRoundedPoint(x1, y1, x2, y2, radius, first) {
        var total = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)),
            idx = first ? radius / total : (total - radius) / total;
        return [x1 + (idx * (x2 - x1)), y1 + (idx * (y2 - y1))]
    }

    function setCtrlsPaused() {
        if (!optCtrls) {
            drawPlayOverlay();
            return
        }
        ctrlPausePlay.style.backgroundPosition = "-71px 0";
        ctrlSlower.style.backgroundPosition = "0 0";
        ctrlSlower.style.marginLeft = "6px";
        ctrlFaster.style.backgroundPosition = "-192px 0";
        ctrlFaster.style.width = "8px";
        ctrlFaster.onclick = stepForward;
        ctrlSlower.onclick = stepBackward
    }

    function setCtrlsPlaying() {
        clearPlayOverlay();
        if (!optCtrls) {
            return
        }
        ctrlPausePlay.style.backgroundPosition = "-95px 0";
        ctrlFaster.style.backgroundPosition = "-20px 0";
        ctrlSlower.style.backgroundPosition = "-165px 0";
        ctrlFaster.style.width = "14px";
        ctrlSlower.style.marginLeft = "0px";
        ctrlFaster.onclick = faster;
        ctrlSlower.onclick = slower
    }

    function pauseClick() {
        if (vid.paused) {
            vid.play();
            setCtrlsPlaying()
        } else {
            vid.pause();
            setCtrlsPaused()
        }
    }

    function gfyMouseOver() {
        if (!optTitle || !gfyItem.title) {
            return
        }
        titleDiv.style.display = "block"
    }

    function gfyMouseOut() {
        if (!optTitle) {
            return
        }
        titleDiv.style.display = "none"
    }

    function reverse() {
        ctrlPausePlay.style.backgroundPosition = "-95px 0";
        ctrlSlower.style.backgroundPosition = "0 0";
        ctrlSlower.style.marginLeft = "6px";
        ctrlFaster.style.backgroundPosition = "-192px 0";
        ctrlFaster.style.width = "8px";
        ctrlFaster.onclick = stepForward;
        ctrlSlower.onclick = stepBackward;
        vid.pause();
        var mp4src = byClass("mp4source", vid)[0];
        var webmsrc = byClass("webmsource", vid)[0];
        if (isReverse) {
            mp4src.src = mp4src.src.replace(/-reverse\.mp4/g, ".mp4");
            mp4src.src = mp4src.src.replace(/-reverse\.webm/g, ".webm");
            webmsrc.src = webmsrc.src.replace(/-reverse\.webm/g, ".webm");
            ctrlReverse.style.backgroundPosition = "-46px 0";
            isReverse = false
        } else {
            mp4src.src = mp4src.src.replace(/\.mp4/g, "-reverse.mp4");
            mp4src.src = mp4src.src.replace(/\.webm/g, "-reverse.webm");
            webmsrc.src = webmsrc.src.replace(/\.webm/g, "-reverse.webm");
            ctrlReverse.style.backgroundPosition = "-141px 0";
            isReverse = true
        }
        vid.playbackRate = 1;
        vid.load();
        vid.play()
    }

    function slower() {
        if (vid.playbackRate <= 1) {
            vid.playbackRate = vid.playbackRate / 2
        } else {
            vid.playbackRate--
        }
    }

    function faster() {
        if (vid.playbackRate <= 1) {
            vid.playbackRate = vid.playbackRate * 2
        } else {
            vid.playbackRate++
        }
    }

    function stepForward() {
        if (window.opera) {
            var storeFunc = vid.onplay;
            vid.onplay = function () {
                vid.pause();
                vid.onplay = storeFunc
            };
            vid.play()
        } else {
            vid.currentTime += (1 / gfyFrameRate)
        }
    }

    function stepBackward() {
        vid.currentTime -= (1 / gfyFrameRate)
    }

    function refresh() {
        vid.load();
        vid.play()
    }
    return {
        init: init,
        refresh: refresh
    }
};
if (document.addEventListener) {
    document.addEventListener("DOMContentLoaded", gfyCollection.init, false)
} else {
    document.attachEvent("onreadystatechange", gfyCollection.init)
};

function linkOut(url) {
    window.open(url, '_blank');
    return false;
}

// Script to prevent from iframe embedding
if (window.top !== window.self) {
    window.top.location.replace(window.self.location.href);
}

function createCookie(name, value, days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        var expires = "; expires=" + date.toGMTString();
    } else var expires = "";
    document.cookie = name + "=" + value + expires + "; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name, "", -1);
}

$(document).ready(function () {

    if ((lang == "cs" || lang == "sk" || lang == "pl" || lang == "hu") && $(window).width() > 768 && readCookie('scrollingDivDisabled') == null) {
        //setTimeout(function() {setScrollingDiv()}, 2000);
    }

    $("#js-close-scrolling-div").live("click", function () {
        $("#scrolling-div").css({
            zIndex: -1,
            opacity: 0
        }).addClass("disabled");
        createCookie('scrollingDivDisabled', true, 365);
    });

});

var fbBox = {
    url: {
        "cs": "http://www.facebook.com/onlajny",
        "pl": "http://www.facebook.com/lajfycom",
        "sk": "http://www.facebook.com/onlajnyeu",
        "hu": "http://www.facebook.com/onlajnok"
    },
    fb: {
        "cs": "cs_CZ",
        "pl": "pl_PL",
        "sk": "sk_SK",
        "hu": "hu_HU"
    },
    title: {
        "cs": "Onlajny.com na Facebooku",
        "pl": "Lajfy.com na Facebooku",
        "sk": "Onlajny.eu na Facebooku",
        "hu": "Onlajnok.com a Facebook-on"
    }
}

function setScrollingDiv(div) {

    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/" + fbBox["fb"][lang] + "/sdk.js#xfbml=1&version=v2.3&appId=517184928319300";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    var $div = "<div id='scrolling-div'><h3>" + fbBox["title"][lang] + " <i id='js-close-scrolling-div' class='fa fa-times pull-right'></i></h3><div><div class='fb-page' data-href='" + fbBox["url"][lang] + "' data-width='240' data-small-header='true' data-adapt-container-width='true' data-hide-cover='false' data-show-facepile='false' data-show-posts='false'><div class='fb-xfbml-parse-ignore'><blockquote cite='" + fbBox["url"][lang] + "'><a href='" + fbBox["url"][lang] + "'>" + fbBox["url"][lang] + "</a></blockquote></div></div></div></div></div>";
    $("#top-bar").prepend($div);
    var $scrollingDiv = $("#scrolling-div");
    var $divTop = $scrollingDiv.offset().top;
    var $gutter = 30;

    if ($(window).height() > ($divTop + $scrollingDiv.outerHeight())) {
        $divTop = ($(window).height() - $scrollingDiv.offset().top - $scrollingDiv.outerHeight() - $gutter);
    }

    $scrollingDiv
        .css({
            marginTop: $(window).scrollTop() + $divTop + "px",
            zIndex: 1000,
            opacity: 1
        });
    // .animate({"opacity" : 1}, "slow");

    $(window).scroll(function () {
        if (!$scrollingDiv.hasClass("disabled")) {
            $scrollingDiv
                .stop()
                .animate({
                    "marginTop": ($(window).scrollTop() + $divTop) + "px"
                }, "slow");
        }
    });
}

function replacePlayerNames(matchLanguageId, text, nr, name2) {

    if (nr == 0) {
        return replacePlayerNames(matchLanguageId, replacePlayerNames(matchLanguageId, text, 1, name2), 2, name2);
    }

    try {
        if (matchLanguageId) {
            var variable = matchesJson[matchLanguageId]['playerUrls'][nr][name2 ? 1 : 0];
        } else {
            var variable = matchJson['playerUrls'][nr][name2 ? 1 : 0];
        }
    } catch (err) {
        return text;
    }

    for (var i = 0; i < variable.length; i++) {
        if (!variable[i][2]) {
            variable[i][2] = new RegExp('(^|[ ,().-])' + variable[i][0].replace(/([\^\$\\\.\+\*\?\{\}\(\)\|\[\]])/g, '\\$1') + '($|[ ,().-])', 'g');
        }
        text = text.replace(variable[i][2], '$1<a href="' + variable[i][1] + '" target="_blank" title="' + lsLangVars['playerUrlTitle'] + '">' + variable[i][0] + '</a>$2');
    }

    return text;
}

function clickTab(el, sel) {
    var par = $(el).closest(".tabBox0");
    $('> *:not(.navigace)', par).hide();
    $('> ' + sel, par).show();
    $(el).removeClass("inactive").siblings().addClass("inactive").each(function () {
        if (!$(this).attr("onclick")) {
            $(this).attr("onclick", "clickTab(this, '*:not(" + sel + ")')");
        }
    });
}

function initTipsort(domNode) {
    var $domNode = $(domNode);
    if ($domNode.data("tipsport")) {
        return true;
    }

    var bets = $domNode.find(".js-comment-bets");
    if (bets.length) {
        specialComment.renderBets(bets);
        $domNode.data("tipsport", 1);
        return true;
    }

    var analysis = $domNode.find(".js-comment-analysis");
    if (analysis.length) {
        specialComment.renderAnalysis(analysis);
        $domNode.data("tipsport", 1);
        return true;
    }

    return false;
}

function isAdblockActive() {
    var test = document.createElement('div');
    test.innerHTML = '&nbsp;';
    test.className = 'adsbox';
    document.body.appendChild(test);

    if (test.offsetHeight === 0) {
        test.remove();
        return true;
    } else {
        test.remove();
        return false;
    }
}

// Adblock detecting and google analytics reporting
$(document).ready(function () {

    if (isAdblockActive()) {
        if (typeof ga !== "undefined") {
            ga('localTracker.send', 'event', 'AdBlock', 'enabled', 'true');
        } else if (typeof _gaq !== "undefined") {
            _gaq.push(['_trackEvent', 'AdBlock', 'enabled', 'true']);
        }
    }

});

function isDevSite() {
    var href = window.location.href;
    return href.indexOf("127.0.0.1") > -1 || href.indexOf("onlajny.info") > -1
}

function closeFriendlyReminder() {
    var body = $("body");
    body.removeClass("friendly-reminder--is-opened");
    $(".friendly-reminder").remove();
    setCookie('friendlyReminder', true, 1);
}

$(document).ready(function () {
    if (isDevSite()) {
        if (readCookie('friendlyReminder') == null && isAdblockActive()) {
            var body = $("body");
            body.addClass("friendly-reminder--is-opened");
            var text = "<div class='friendly-reminder'>\
            <div class='friendly-reminder__body'>\
                <div class='friendly-reminder__title'>" + translations.weNoticed + "</div>\
                <div class='friendly-reminder__smiley'><img src='https://onlajny.s3.amazonaws.com/img/smileey.png' width='133' height='133' /></div>\
                <div class='friendly-reminder__text'>\
                    <p>" + translations.popupLine1 + "</p>\
                    <p>" + translations.popupLine2 + "</p>\
                </div>\
                <div class='friendly-reminder__button-wrap'><a href='javascript:closeFriendlyReminder();' class='friendly-reminder__button'>" + translations.popupContinue + "</a></div>\
            </div>\
            </div>";
            body.append(text)
        }
    }
});